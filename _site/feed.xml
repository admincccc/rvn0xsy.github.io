<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>倾旋的博客</title>
    <description>岁月静好，现世安稳。
</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 02 May 2018 00:42:46 +0800</pubDate>
    <lastBuildDate>Wed, 02 May 2018 00:42:46 +0800</lastBuildDate>
    <generator>Jekyll v3.6.2</generator>
    
      <item>
        <title>Windows内网渗透基础命令</title>
        <description>&lt;p&gt;整理的一些内网渗透基础命令
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-前言&quot;&gt;0x00 前言&lt;/h2&gt;

&lt;p&gt;所有环境均为本地搭建测试。&lt;/p&gt;

&lt;h2 id=&quot;0x01-网络命令&quot;&gt;0x01 网络命令&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;命令&lt;/th&gt;
      &lt;th&gt;语义&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;ipconfig /all&lt;/td&gt;
      &lt;td&gt;获取网络配置信息&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:\Users\administrator&amp;gt;ipconfig /all
Windows IP 配置

   主机名  . . . . . . . . . . . . . : LIYINGZHEA30B
   主 DNS 后缀 . . . . . . . . . . . : payloads.online
   节点类型  . . . . . . . . . . . . : 混合
   IP 路由已启用 . . . . . . . . . . : 否
   WINS 代理已启用 . . . . . . . . . : 否
   DNS 后缀搜索列表  . . . . . . . . : payloads.online
                                       localdomain

以太网适配器 本地连接:
   连接特定的 DNS 后缀 . . . . . . . : localdomain
   描述. . . . . . . . . . . . . . . : Intel(R) PRO/1000 MT Network Connection
   物理地址. . . . . . . . . . . . . : 00-1C-42-FE-2D-C3
   DHCP 已启用 . . . . . . . . . . . : 是
   自动配置已启用. . . . . . . . . . : 是
   IPv6 地址 . . . . . . . . . . . . : fdb2:2c26:f4e4:0:9df6:d0e9:1af1:89d9(首选)
   临时 IPv6 地址. . . . . . . . . . : fdb2:2c26:f4e4:0:1899:1d95:681e:22d8(首选)
   本地链接 IPv6 地址. . . . . . . . : fe80::9df6:d0e9:1af1:89d9%11(首选)
   IPv4 地址 . . . . . . . . . . . . : 10.211.55.11(首选)
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   获得租约的时间  . . . . . . . . . : 2018年5月1日 下午10:13:33
   租约过期的时间  . . . . . . . . . : 2018年5月1日 下午10:47:07
   默认网关. . . . . . . . . . . . . : fe80::21c:42ff:fe00:18%11
                                       10.211.55.1
   DHCP 服务器 . . . . . . . . . . . : 10.211.55.1
   DHCPv6 IAID . . . . . . . . . . . : 234888258
   DHCPv6 客户端 DUID  . . . . . . . : 00-01-00-01-21-D7-A6-F6-00-1C-42-FE-2D-C3

   DNS 服务器  . . . . . . . . . . . : fe80::21c:42ff:fe00:18%11
                                       192.168.3.18
   TCPIP 上的 NetBIOS  . . . . . . . : 已启用

隧道适配器 Teredo Tunneling Pseudo-Interface:

   媒体状态  . . . . . . . . . . . . : 媒体已断开
   连接特定的 DNS 后缀 . . . . . . . :
   描述. . . . . . . . . . . . . . . : Teredo Tunneling Pseudo-Interface
   物理地址. . . . . . . . . . . . . : 00-00-00-00-00-00-00-E0
   DHCP 已启用 . . . . . . . . . . . : 否
   自动配置已启用. . . . . . . . . . : 是

C:\Users\administrator&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;通过以上信息我们可以获取域名、IP地址、DHCP服务器、网关、MAC地址、主机名&lt;/p&gt;

</description>
        <pubDate>Tue, 01 May 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-05-01/1</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-05-01/1</guid>
        
        
        <category>内网渗透</category>
        
      </item>
    
      <item>
        <title>XSS跨站脚本漏洞</title>
        <description>&lt;p&gt;《Web安全测试学习手册》- XSS跨站脚本漏洞
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-xss跨站脚本漏洞&quot;&gt;0x00 XSS跨站脚本漏洞&lt;/h2&gt;

&lt;h3 id=&quot;1什么是xss跨站脚本漏洞&quot;&gt;1）什么是XSS跨站脚本漏洞&lt;/h3&gt;

&lt;p&gt;跨站脚本（cross site script）为了避免与样式css混淆，所以简称为XSS。&lt;/p&gt;

&lt;p&gt;XSS是一种经常出现在web应用中的计算机安全漏洞，也是web中最主流的攻击方式。那么什么是XSS呢？&lt;/p&gt;

&lt;p&gt;XSS是指恶意攻击者利用网站没有对用户提交数据进行转义处理或者过滤不足的缺点，进而添加一些代码，嵌入到web页面中去。使别的用户访问都会执行相应的嵌入代码。&lt;/p&gt;

&lt;p&gt;从而盗取用户资料、利用用户身份进行某种动作或者对访问者进行病毒侵害的一种攻击方式。&lt;/p&gt;

&lt;h3 id=&quot;2xss跨站脚本漏洞的特点&quot;&gt;2）XSS跨站脚本漏洞的特点&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;所有攻击操作均在浏览器上实现&lt;/li&gt;
  &lt;li&gt;大多使用Javascript代码&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x01-xss跨站脚本漏洞---风险等级&quot;&gt;0x01 XSS跨站脚本漏洞 - 风险等级&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;高&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x02-xss跨站脚本漏洞---原理&quot;&gt;0x02 XSS跨站脚本漏洞 - 原理&lt;/h2&gt;

&lt;p&gt;是指恶意攻击者利用网站没有对用户提交数据进行转义处理或者过滤不足的缺点，进而添加一些代码，嵌入到web页面中去。使别的用户访问都会执行相应的嵌入代码。&lt;/p&gt;

&lt;h2 id=&quot;0x03-xss跨站脚本漏洞---常见场景&quot;&gt;0x03 XSS跨站脚本漏洞 - 常见场景&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;留言板&lt;/li&gt;
  &lt;li&gt;SNS社区&lt;/li&gt;
  &lt;li&gt;文章发布&lt;/li&gt;
  &lt;li&gt;论坛&lt;/li&gt;
  &lt;li&gt;….&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x04-测试方案&quot;&gt;0x04 测试方案&lt;/h2&gt;

&lt;p&gt;在输入点提交如下payload，查看响应内容、结果，判断&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;gt;、&quot;、'、&amp;lt;、/、*&lt;/code&gt;等字符是否过滤&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;gt;&quot;'&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;'';!--&quot;&amp;lt;XSS&amp;gt;=&amp;amp;{()}&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;'';!--&quot;&amp;lt;script&amp;gt;alert(0);&amp;lt;/script&amp;gt;=&amp;amp;{()}&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;'';!--&quot;&amp;lt;script&amp;gt;alert(0);&amp;lt;/script&amp;gt;=&amp;amp;{(alert(1))}&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;gt;&amp;lt;script&amp;gt;alert(0)&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;');alert(0);//&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/&amp;gt;&amp;lt;SCRIPT&amp;gt;/*s*/alert(String.from+CharCode(88, 83, 83))&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;//&quot;&amp;gt;&amp;lt;scriPT&amp;gt;console.log(0);&amp;lt;/sCRIpt&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;script/onreadystatechange=alert(1)&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;img src=&quot;--&amp;gt;&amp;lt;img src=x onerror=alert(1)//&quot;&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;svg/onload=alert(1)&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;&amp;gt;&amp;lt;/object&amp;gt;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;....&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;若代码能够执行，则存在XSS跨站脚本漏洞&lt;/p&gt;

&lt;h2 id=&quot;0x05-修复方案&quot;&gt;0x05 修复方案&lt;/h2&gt;

&lt;h3 id=&quot;php&quot;&gt;PHP&lt;/h3&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;strip_tags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;允许标签&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;     &lt;span class=&quot;c1&quot;&gt;#从字符串中去除 HTML 和 PHP 标记
&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;htmlentities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;           	&lt;span class=&quot;c1&quot;&gt;#转义html实体
&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;html_entity_decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;     	&lt;span class=&quot;c1&quot;&gt;#反转义html实体
&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;addcslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'字符'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;     	&lt;span class=&quot;c1&quot;&gt;#给某些字符加上反斜杠
&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;stripcslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;          	&lt;span class=&quot;c1&quot;&gt;#去掉反斜杠
&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;addslashes&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;              &lt;span class=&quot;c1&quot;&gt;#单引号、双引号、反斜线与 NULL加反斜杠
&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;stripslashes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;              &lt;span class=&quot;c1&quot;&gt;#去掉反斜杠
&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;htmlspecialchars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;              &lt;span class=&quot;c1&quot;&gt;#特殊字符转换为HTML实体
&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;htmlspecialchars_decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;#将特殊的 HTML 实体转换回普通字符
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;java&quot;&gt;Java&lt;/h3&gt;

&lt;p&gt;方法一：特殊字符替换&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;        
     &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;'&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;apos;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;replaceAll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;amp;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//&quot;&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;\t&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;nbsp;&amp;amp;nbsp;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 替换跳格&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;nbsp;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 替换空格&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;lt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;replaceAll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&amp;amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;方法二：&lt;/p&gt;

&lt;p&gt;apache工具包common-lang中有一个很有用的处理字符串的工具类，其中之一就是StringEscapeUtils,这个工具类是在2.3版本以上加上的去的，利用它能很方便的进行html,xml,java等的转义与反转义&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;org.apache.commons.lang3&lt;/code&gt;包有个&lt;code class=&quot;highlighter-rouge&quot;&gt;StringEscapeUtils&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;StringEscapeUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;unescapeHtml4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;方法三：&lt;/p&gt;

&lt;p&gt;org.springframework.web.util.HtmlUtils 可以实现HTML标签及转义字符之间的转换。&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cm&quot;&gt;/** HTML转义 **/&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HtmlUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;htmlEscape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&amp;lt;div&amp;gt;hello world&amp;lt;/div&amp;gt;&amp;lt;p&amp;gt;&amp;amp;nbsp;&amp;lt;/p&amp;gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HtmlUtils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;htmlUnescape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;执行结果&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;amp;lt;div&amp;amp;gt;hello world&amp;amp;lt;/div&amp;amp;gt;&amp;amp;lt;p&amp;amp;gt;&amp;amp;amp;nbsp;&amp;amp;lt;/p&amp;amp;gt;  
  
&amp;lt;div&amp;gt;hello world&amp;lt;/div&amp;gt;&amp;lt;p&amp;gt;&amp;amp;nbsp;&amp;lt;/p&amp;gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Sat, 28 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-28/2</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-28/2</guid>
        
        
        <category>Web安全测试学习手册</category>
        
      </item>
    
      <item>
        <title>分布式部署文件可读</title>
        <description>&lt;p&gt;《Web安全测试学习手册》- 分布式部署文件可读
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-分布式部署文件可读&quot;&gt;0x00 分布式部署文件可读&lt;/h2&gt;

&lt;h3 id=&quot;1什么是分布式部署文件可读&quot;&gt;1）什么是分布式部署文件可读&lt;/h3&gt;

&lt;p&gt;Apache中的&lt;code class=&quot;highlighter-rouge&quot;&gt;.htaccess&lt;/code&gt;或者”分布式配置”了针对目录改变配置的方法，即，在特定的文档目录中放置包含或多个指令的，以作用于此目录及其子目录。&lt;/p&gt;

&lt;p&gt;这个文件默认情况下客户端是不可读的，假设客户端能够读取此文件，攻击者利用这一特性可以获取分布式配置的指令，泄漏服务器端敏感信息。&lt;/p&gt;

&lt;h3 id=&quot;2分布式部署文件可读的特点&quot;&gt;2）分布式部署文件可读的特点&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;.ht开头文件可读&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x01-分布式部署文件可读---风险等级&quot;&gt;0x01 分布式部署文件可读 - 风险等级&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;高&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x02-分布式部署文件可读---原理&quot;&gt;0x02 分布式部署文件可读 - 原理&lt;/h2&gt;

&lt;p&gt;客户端请求类似于如下URL：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;http://payloads.online/.htaccess&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Web中间件将读取&lt;code class=&quot;highlighter-rouge&quot;&gt;.htaccess&lt;/code&gt;文件内容响应给客户端，客户端能够获取分布式配置指令。&lt;/p&gt;

&lt;h2 id=&quot;0x03-分布式部署文件可读---常见场景&quot;&gt;0x03 分布式部署文件可读 - 常见场景&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Apache Web 服务器&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x04-测试方案&quot;&gt;0x04 测试方案&lt;/h2&gt;

&lt;p&gt;使用CURL访问分布式配置文件&lt;/p&gt;

&lt;p&gt;命令：&lt;code class=&quot;highlighter-rouge&quot;&gt;curl -I http://payloads.online/.htaccess&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;➜  ~ curl -I http://10.211.55.12/.htaccess
HTTP/1.1 200 OK
Date: Sat, 28 Apr 2018 02:31:02 GMT
Last-Modified: Sat, 28 Apr 2018 02:30:16 GMT
ETag: &quot;17-56adf66b3a848&quot;
Accept-Ranges: bytes
Content-Length: 23
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;若响应状态码为&lt;code class=&quot;highlighter-rouge&quot;&gt;200&lt;/code&gt;则存在此风险&lt;/p&gt;

&lt;h2 id=&quot;0x05-修复方案&quot;&gt;0x05 修复方案&lt;/h2&gt;

&lt;p&gt;在Apache的配置文件httpd.conf中添加：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;Files &quot;.ht*&quot;&amp;gt;
    Require all denied
&amp;lt;/Files&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;修复后：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;➜  ~ curl -I http://10.211.55.12/.htaccess
HTTP/1.1 403 Forbidden
Date: Sat, 28 Apr 2018 02:35:22 GMT
Content-Type: text/html; charset=iso-8859-1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
        <pubDate>Sat, 28 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-28/1</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-28/1</guid>
        
        
        <category>Web安全测试学习手册</category>
        
      </item>
    
      <item>
        <title>应用程序未容错</title>
        <description>&lt;p&gt;《Web安全测试学习手册》- 应用程序未容错
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-应用程序未容错&quot;&gt;0x00 应用程序未容错&lt;/h2&gt;

&lt;h3 id=&quot;1什么是应用程序未容错&quot;&gt;1）什么是应用程序未容错&lt;/h3&gt;

&lt;p&gt;应用程序未屏蔽执行过程中的错误信息，直接抛出了异常。&lt;/p&gt;

&lt;h3 id=&quot;2应用程序未容错的特点&quot;&gt;2）应用程序未容错的特点&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;产生异常&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x01-应用程序未容错---风险等级&quot;&gt;0x01 应用程序未容错 - 风险等级&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;低&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x02-应用程序未容错---原理&quot;&gt;0x02 应用程序未容错 - 原理&lt;/h2&gt;

&lt;p&gt;一般情况下是Web应用程序接收用户输入的信息后，未捕获异常，如：数据类型错误、空值、非法字符造成程序不能继续执行，导致抛出错误信息。&lt;/p&gt;

&lt;h2 id=&quot;0x03-应用程序未容错---常见场景&quot;&gt;0x03 应用程序未容错 - 常见场景&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;查询功能&lt;/li&gt;
  &lt;li&gt;上传文件功能&lt;/li&gt;
  &lt;li&gt;访问不存在的页面&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x04-测试方案&quot;&gt;0x04 测试方案&lt;/h2&gt;

&lt;p&gt;向Web应用提交一些恶意字符：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;%df&lt;/li&gt;
  &lt;li&gt;%27&lt;/li&gt;
  &lt;li&gt;%20&lt;/li&gt;
  &lt;li&gt;’&lt;/li&gt;
  &lt;li&gt;}&lt;/li&gt;
  &lt;li&gt;;&lt;/li&gt;
  &lt;li&gt;)&lt;/li&gt;
  &lt;li&gt;-&lt;/li&gt;
  &lt;li&gt;&lt;/li&gt;
  &lt;li&gt;../../&lt;/li&gt;
  &lt;li&gt;….（省略）&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-04-27/0x03.png&quot; alt=&quot;应用程序未容错&quot; /&gt;&lt;/p&gt;

&lt;p&gt;上面这个场景是由于id值将要被带入数据库查询，而我们没有提交id，id也没有默认值，导致经过&lt;code class=&quot;highlighter-rouge&quot;&gt;toInt&lt;/code&gt;方法时报错。&lt;/p&gt;

&lt;p&gt;PS:toInt无法将空值转换成数字。&lt;/p&gt;

&lt;h2 id=&quot;0x05-修复方案&quot;&gt;0x05 修复方案&lt;/h2&gt;

&lt;h3 id=&quot;php&quot;&gt;PHP&lt;/h3&gt;

&lt;p&gt;在页面中添加：&lt;/p&gt;
&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;error_reporting&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;或更改php.ini&lt;/p&gt;

&lt;p&gt;display_errors的默认值为On，代表显示错误提示，如果设置为Off，就会关闭所有的错误提示。&lt;/p&gt;

&lt;h3 id=&quot;tomcat&quot;&gt;Tomcat&lt;/h3&gt;

&lt;p&gt;修改 web.xml，加入如下代码：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;error-page&amp;gt; 
  &amp;lt;error-code&amp;gt;500&amp;lt;/error-code&amp;gt; 
  &amp;lt;location&amp;gt;/error.jsp&amp;lt;/location&amp;gt; 
&amp;lt;/error-page&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;iis&quot;&gt;IIS&lt;/h3&gt;

&lt;p&gt;“网站属性”-&amp;gt;“主目录”-&amp;gt;“应用程序配置”-&amp;gt;调试，选择“向客户端发送下列文本信息”&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-04-27/0x04.gif&quot; alt=&quot;应用程序未容错&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Fri, 27 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-27/3</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-27/3</guid>
        
        
        <category>Web安全测试学习手册</category>
        
      </item>
    
      <item>
        <title>服务器端目录遍历</title>
        <description>&lt;p&gt;《Web安全测试学习手册》- 服务器端目录遍历
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-服务器端目录遍历&quot;&gt;0x00 服务器端目录遍历&lt;/h2&gt;

&lt;h3 id=&quot;1什么是服务器端目录遍历&quot;&gt;1）什么是服务器端目录遍历&lt;/h3&gt;

&lt;p&gt;当客户端访问到一个目录时，Web服务中间件将会默认寻找一个&lt;code class=&quot;highlighter-rouge&quot;&gt;index list&lt;/code&gt;中的文件，若文件不存在，则会列出当前目录下所有文件或返回403状态码，而列出目录下所有文件的行为称为目录遍历。&lt;/p&gt;

&lt;h3 id=&quot;2服务器端目录遍历的特点&quot;&gt;2）服务器端目录遍历的特点&lt;/h3&gt;

&lt;p&gt;中间件配置不得当&lt;/p&gt;

&lt;h2 id=&quot;0x01-服务器端目录遍历---风险等级&quot;&gt;0x01 服务器端目录遍历 - 风险等级&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;高&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x02-服务器端目录遍历---原理&quot;&gt;0x02 服务器端目录遍历 - 原理&lt;/h2&gt;

&lt;p&gt;当客户端访问到一个目录时，Web服务中间件将会默认寻找一个&lt;code class=&quot;highlighter-rouge&quot;&gt;index list&lt;/code&gt;中的文件，若文件不存在，则会列出当前目录下所有文件或返回403状态码。&lt;/p&gt;

&lt;h2 id=&quot;0x03-服务器端目录遍历---常见场景&quot;&gt;0x03 服务器端目录遍历 - 常见场景&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Tomcat&lt;/li&gt;
  &lt;li&gt;Nginx&lt;/li&gt;
  &lt;li&gt;Apache&lt;/li&gt;
  &lt;li&gt;IIS&lt;/li&gt;
  &lt;li&gt;… 均有此类现象&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x04-测试方案&quot;&gt;0x04 测试方案&lt;/h2&gt;

&lt;p&gt;先使用dirb扫描一些存在的目录，再使用浏览器访问已存在的目录，查看是否能够列出目录下的文件&lt;/p&gt;

&lt;p&gt;命令：&lt;code class=&quot;highlighter-rouge&quot;&gt;dirb http://target&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-04-27/0x02.gif&quot; alt=&quot;0x02&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x05-修复方案&quot;&gt;0x05 修复方案&lt;/h2&gt;

&lt;h4 id=&quot;apache&quot;&gt;Apache&lt;/h4&gt;

&lt;h5 id=&quot;修改站点目录对应的配置文件&quot;&gt;修改站点目录对应的配置文件&lt;/h5&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x00.png&quot; alt=&quot;列出目录索引&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;Directory /&amp;gt;
    Options +Indexes +FollowSymLinks # 将 &quot;+&quot; 与 Indexes 去掉即可限制列出目录索引
    AllowOverride All
    Order allow,deny
    Allow from all
    Require all granted
&amp;lt;/Directory&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;修改后：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;Directory /&amp;gt;
    Options FollowSymLinks
    AllowOverride All
    Order allow,deny
    Allow from all
    Require all granted
&amp;lt;/Directory&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x01.png&quot; alt=&quot;不列出目录索引&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;创建directoryindex默认文件&quot;&gt;创建DirectoryIndex默认文件&lt;/h5&gt;

&lt;p&gt;大家都见过很多框架的每个目录都有一个&lt;code class=&quot;highlighter-rouge&quot;&gt;index.html&lt;/code&gt;文件，这个文件的存在是非常有意义的，很多线上的Web服务器都没有合格配置&lt;code class=&quot;highlighter-rouge&quot;&gt;列出目录索引&lt;/code&gt;。导致网站内部许多文件都被攻击者查看到，泄漏大量信息。&lt;/p&gt;

&lt;p&gt;为了防止列出目录索引，我们可以在站点的每个文件夹中创建一个&lt;code class=&quot;highlighter-rouge&quot;&gt;index.html&lt;/code&gt;，这个文件内容是什么都无所谓了。当攻击者想通过列目录的手法访问你站点文件夹的时候，Web服务器将会判断当前目录下有没有&lt;code class=&quot;highlighter-rouge&quot;&gt;DirectoryIndex&lt;/code&gt;默认首页，如果存在就显示&lt;code class=&quot;highlighter-rouge&quot;&gt;DirectoryIndex&lt;/code&gt;对应的文件名的内容，这样攻击者就无法查看该目录下有什么文件了。&lt;/p&gt;

&lt;h4 id=&quot;tomcat&quot;&gt;Tomcat&lt;/h4&gt;

&lt;h5 id=&quot;修改confwebxml配置文件&quot;&gt;修改conf/web.xml配置文件&lt;/h5&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x02.png&quot; alt=&quot;列出目录索引&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;init-param&amp;gt;
            &amp;lt;param-name&amp;gt;listings&amp;lt;/param-name&amp;gt; 
            &amp;lt;param-value&amp;gt;true&amp;lt;/param-value&amp;gt; &amp;lt;!-- 将true改为false --&amp;gt;
&amp;lt;/init-param&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;修改后：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;init-param&amp;gt;
            &amp;lt;param-name&amp;gt;listings&amp;lt;/param-name&amp;gt; 
            &amp;lt;param-value&amp;gt;false&amp;lt;/param-value&amp;gt;
&amp;lt;/init-param&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x03.png&quot; alt=&quot;不列出目录索引&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;nginx&quot;&gt;Nginx&lt;/h4&gt;

&lt;h5 id=&quot;修改confnginxconf配置文件&quot;&gt;修改conf/nginx.conf配置文件&lt;/h5&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x05.png&quot; alt=&quot;列出目录索引&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;location / {
            index  index.html index.htm index.php l.php;
           autoindex on;  
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;修改后：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;location / {
            index  index.html index.htm index.php l.php;
           autoindex off;  
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x04.png&quot; alt=&quot;不列出目录索引&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;iis&quot;&gt;IIS&lt;/h4&gt;

&lt;h4 id=&quot;设置目录浏览权限&quot;&gt;设置”目录浏览”权限&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x06.png&quot; alt=&quot;列出目录索引&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x08.png&quot; alt=&quot;设置目录索引&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2017-11-15/0x07.png&quot; alt=&quot;不列出目录索引&quot; /&gt;&lt;/p&gt;

</description>
        <pubDate>Fri, 27 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-27/1</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-27/1</guid>
        
        
        <category>Web安全测试学习手册</category>
        
      </item>
    
      <item>
        <title>SVN文件泄露</title>
        <description>&lt;p&gt;《Web安全测试学习手册》- SVN文件泄露
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-svn文件泄露&quot;&gt;0x00 SVN文件泄露&lt;/h2&gt;

&lt;h3 id=&quot;1什么是svn文件泄露&quot;&gt;1）什么是SVN文件泄露&lt;/h3&gt;

&lt;p&gt;Subversion，简称SVN，是一个开放源代码的版本控制系统，相对于的RCS、CVS，采用了分支管理系统，它的设计目标就是取代CVS。互联网上越来越多的控制服务从CVS转移到Subversion。&lt;/p&gt;

&lt;p&gt;Subversion使用服务端—客户端的结构，当然服务端与客户端可以都运行在同一台服务器上。在服务端是存放着所有受控制数据的Subversion仓库，另一端是Subversion的客户端程序，管理着受控数据的一部分在本地的映射（称为“工作副本”）。在这两端之间，是通过各种仓库存取层（Repository Access，简称RA）的多条通道进行访问的。这些通道中，可以通过不同的网络协议，例如HTTP、SSH等，或本地文件的方式来对仓库进行操作。&lt;/p&gt;

&lt;h3 id=&quot;2svn文件泄露的特点&quot;&gt;2）SVN文件泄露的特点&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Web目录中存在&lt;code class=&quot;highlighter-rouge&quot;&gt;.svn&lt;/code&gt;目录&lt;/li&gt;
  &lt;li&gt;Web中间件未限制客户端访问带&lt;code class=&quot;highlighter-rouge&quot;&gt;.&lt;/code&gt;目录，例如:&lt;code class=&quot;highlighter-rouge&quot;&gt;.conf/、.svn/、.data/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x01-svn文件泄露---风险等级&quot;&gt;0x01 SVN文件泄露 - 风险等级&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;高&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x02-svn文件泄露---原理&quot;&gt;0x02 SVN文件泄露 - 原理&lt;/h2&gt;

&lt;p&gt;由于网站管理员在上线的时候使用了SVN服务，&lt;code class=&quot;highlighter-rouge&quot;&gt;checkout&lt;/code&gt;完毕并没有删除&lt;code class=&quot;highlighter-rouge&quot;&gt;.svn&lt;/code&gt;这个隐藏目录，并且中间件没有禁止客户端访问这一目录。&lt;/p&gt;

&lt;h2 id=&quot;0x03-svn文件泄露---常见场景&quot;&gt;0x03 SVN文件泄露 - 常见场景&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;存在&lt;code class=&quot;highlighter-rouge&quot;&gt;.svn&lt;/code&gt;目录的Web应用&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x04-测试方案&quot;&gt;0x04 测试方案&lt;/h2&gt;

&lt;h3 id=&quot;方案一&quot;&gt;方案一&lt;/h3&gt;

&lt;p&gt;使用浏览器或CURL探测：http://target/.svn/entries，查看&lt;code class=&quot;highlighter-rouge&quot;&gt;entries&lt;/code&gt;这个文件是否存在。&lt;/p&gt;

&lt;p&gt;命令：curl -I http://target/.svn/entries&lt;/p&gt;

&lt;p&gt;例如：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;➜  ~ curl -I http://10.211.55.12/.svn/entries
HTTP/1.1 200 OK
Date: Fri, 27 Apr 2018 08:12:54 GMT
Last-Modified: Fri, 27 Apr 2018 07:43:25 GMT
Accept-Ranges: bytes
Content-Length: 3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;方案二&quot;&gt;方案二&lt;/h3&gt;

&lt;p&gt;使用检测工具&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-04-27/0x05.png&quot; alt=&quot;SVN文件泄露&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;方案三&quot;&gt;方案三&lt;/h3&gt;

&lt;h2 id=&quot;0x05-修复方案&quot;&gt;0x05 修复方案&lt;/h2&gt;

&lt;h3 id=&quot;方案一-1&quot;&gt;方案一&lt;/h3&gt;

&lt;p&gt;删除&lt;code class=&quot;highlighter-rouge&quot;&gt;.svn&lt;/code&gt;目录&lt;/p&gt;

&lt;h3 id=&quot;方案二-1&quot;&gt;方案二&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Nginx服务器&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;在&lt;code class=&quot;highlighter-rouge&quot;&gt;nginx.conf&lt;/code&gt;中添加如下代码：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;location ~ ^(.*)\/\.svn\/
{
	return 404;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;重启nginx&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Apache服务器&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;在&lt;code class=&quot;highlighter-rouge&quot;&gt;httpd.conf&lt;/code&gt;中添加如下代码：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;Directory &quot;WEB绝对路径/.svn/&quot;&amp;gt;
   Order deny,allow
   Deny from all
&amp;lt;/Directory&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
        <pubDate>Fri, 27 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-27/4</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-27/4</guid>
        
        
        <category>Web安全测试学习手册</category>
        
      </item>
    
      <item>
        <title>OpenSSL心脏滴血漏洞</title>
        <description>&lt;p&gt;《Web安全测试学习手册》- OpenSSL心脏滴血漏洞
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-openssl心脏滴血漏洞&quot;&gt;0x00 OpenSSL心脏滴血漏洞&lt;/h2&gt;

&lt;h3 id=&quot;1什么是openssl心脏滴血漏洞&quot;&gt;1）什么是OpenSSL心脏滴血漏洞&lt;/h3&gt;

&lt;p&gt;2014年4月8日，互联网上曝出了严重一个漏洞称为Heartbleed，该漏洞由安全公司Codenomicon和谷歌安全工程师发现。Heartbleed漏洞，造成许任何人在互联网上阅读系统的内存保护脆弱的OpenSSL的软件版本。 这种妥协密钥用于识别服务提供者和加密流量,用户名和密码的和实际的内容。 这允许攻击者窃听通信、窃取数据直接从服务和用户和模拟服务和用户。&lt;/p&gt;

&lt;h3 id=&quot;2openssl心脏滴血漏洞的特点&quot;&gt;2）OpenSSL心脏滴血漏洞的特点&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;服务器端必须支持openssl加密协议，如：https&lt;/li&gt;
  &lt;li&gt;危害大&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x01-openssl心脏滴血漏洞---风险等级&quot;&gt;0x01 OpenSSL心脏滴血漏洞 - 风险等级&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;高&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x02-openssl心脏滴血漏洞---原理&quot;&gt;0x02 OpenSSL心脏滴血漏洞 - 原理&lt;/h2&gt;

&lt;p&gt;2014年4月7日OpenSSL发布了安全公告，在OpenSSL1.0.1版本中存在严重漏洞（CVE-2014-0160），此次漏洞问题存在于ssl/dl_both.c文件中。&lt;/p&gt;

&lt;p&gt;OpenSSL在实现TLS和DTLS的心跳处理逻辑时，存在编码缺陷。OpenSSL的心跳处理逻辑没有检测心跳包中的长度字段是否和后续的数据字段相符合，攻击者可以利用这点，构造异常的数据包，来获取心跳数据所在的内存区域的后续数据。这些数据中可能包含了证书私钥、用户名、用户密码、用户邮箱等敏感信息。该漏洞允许攻击者，从内存中读取多达64KB的数据。&lt;/p&gt;

&lt;h2 id=&quot;0x03-openssl心脏滴血漏洞---常见场景&quot;&gt;0x03 OpenSSL心脏滴血漏洞 - 常见场景&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;使用了openssl扩展库加密的网络协议&lt;/li&gt;
  &lt;li&gt;https&lt;/li&gt;
  &lt;li&gt;SSL VPN&lt;/li&gt;
  &lt;li&gt;邮件服务器&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x04-测试方案&quot;&gt;0x04 测试方案&lt;/h2&gt;

&lt;h3 id=&quot;方案一&quot;&gt;方案一&lt;/h3&gt;

&lt;p&gt;使用Nmap扩展脚本进行扫描&lt;/p&gt;

&lt;p&gt;命令：&lt;code class=&quot;highlighter-rouge&quot;&gt;nmap -sV -p 443 --script ssl-heartbleed.nse [Target]&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-04-27/0x06.png&quot; alt=&quot;OpenSSL心脏滴血漏洞&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;方案二&quot;&gt;方案二&lt;/h3&gt;

&lt;p&gt;https://filippo.io/Heartbleed/&lt;/p&gt;

&lt;h3 id=&quot;方案三&quot;&gt;方案三&lt;/h3&gt;

&lt;p&gt;http://wangzhan.360.cn/heartbleed/&lt;/p&gt;

&lt;h2 id=&quot;0x05-修复方案&quot;&gt;0x05 修复方案&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;1.将受影响的服务器下线，避免它继续泄露敏感信息。&lt;/li&gt;
  &lt;li&gt;2.停止旧版的 openssl 服务，升级 openssl 到新版本，并重新启动。&lt;/li&gt;
  &lt;li&gt;3.生成新密钥。（因为攻击者可能通过漏洞获取私钥。）将新密钥提交给你的CA，获得新的认证之后在服务器上安装新密钥。&lt;/li&gt;
  &lt;li&gt;4.服务器上线。&lt;/li&gt;
  &lt;li&gt;5.撤销旧认证。&lt;/li&gt;
  &lt;li&gt;6.撤销现有的会话cookies。&lt;/li&gt;
  &lt;li&gt;7.要求用户修改密码。&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Fri, 27 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-27/5</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-27/5</guid>
        
        
        <category>Web安全测试学习手册</category>
        
      </item>
    
      <item>
        <title>IIS短文件名漏洞</title>
        <description>&lt;p&gt;《Web安全测试学习手册》- IIS短文件名漏洞
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-iis短文件名漏洞&quot;&gt;0x00 IIS短文件名漏洞&lt;/h2&gt;

&lt;h3 id=&quot;1什么是iis短文件名漏洞&quot;&gt;1）什么是IIS短文件名漏洞&lt;/h3&gt;

&lt;p&gt;IIS短文件名是一个Windows系统为了兼容16位MS-DOS程序，Windows为文件名较长的文件（和文件夹）生成了对应的windows 8.3 短文件名。当这种特性被IIS中间件继承后，我们就可以使用短文件名进行目录猜解。&lt;/p&gt;

&lt;h3 id=&quot;2iis短文件名漏洞的特点&quot;&gt;2）IIS短文件名漏洞的特点&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;利用难度低&lt;/li&gt;
  &lt;li&gt;会产生很多请求&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x01-iis短文件名漏洞---风险等级&quot;&gt;0x01 IIS短文件名漏洞 - 风险等级&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;低&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x02-iis短文件名漏洞---原理&quot;&gt;0x02 IIS短文件名漏洞 - 原理&lt;/h2&gt;

&lt;p&gt;当我们访问一个长名称目录的时候：&lt;code class=&quot;highlighter-rouge&quot;&gt;http://192.168.1.1/administrator&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;这个&lt;code class=&quot;highlighter-rouge&quot;&gt;administrator&lt;/code&gt;目录可以根据Windows 8.3格式简写为&lt;code class=&quot;highlighter-rouge&quot;&gt;admini~1&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;根据这个上述格式，我们访问&lt;code class=&quot;highlighter-rouge&quot;&gt;/admini~1&lt;/code&gt;也可以相当于访问&lt;code class=&quot;highlighter-rouge&quot;&gt;administrator&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x03-服务器端目录遍历---常见场景&quot;&gt;0x03 服务器端目录遍历 - 常见场景&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;IIS 中间件&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x04-测试方案&quot;&gt;0x04 测试方案&lt;/h2&gt;

&lt;h3 id=&quot;方案一&quot;&gt;方案一&lt;/h3&gt;

&lt;p&gt;使用&lt;code class=&quot;highlighter-rouge&quot;&gt;IIS_shortname_Scanner&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;命令：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;git clone https://github.com/lijiejie/IIS_shortname_Scanner.git&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;cd IIS_shortname_Scanner&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;python iis_shortname_Scan.py http://target&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-04-27/0x02.png&quot; alt=&quot;0x02&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;方案二需服务器权限&quot;&gt;方案二（需服务器权限）&lt;/h3&gt;

&lt;p&gt;执行命令（管理员权限）：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem\ /v &quot;NtfsDisable8dot3NameCreation&quot;

-----------------------------------------------------------------
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem
    NtfsDisable8dot3NameCreation    REG_DWORD    0x0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;若&lt;code class=&quot;highlighter-rouge&quot;&gt;NtfsDisable8dot3NameCreation&lt;/code&gt;是&lt;code class=&quot;highlighter-rouge&quot;&gt;0x0&lt;/code&gt;，存在此漏洞&lt;/p&gt;

&lt;h2 id=&quot;0x05-修复方案&quot;&gt;0x05 修复方案&lt;/h2&gt;

&lt;h3 id=&quot;通用方案&quot;&gt;通用方案&lt;/h3&gt;

&lt;p&gt;执行命令（管理员权限）：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem\ /
v &quot;NtfsDisable8dot3NameCreation&quot; /t REG_DWORD /d 1 /f
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;windows-server-2008-r2&quot;&gt;Windows Server 2008 R2&lt;/h3&gt;

&lt;p&gt;查询是否开启短文件名功能：&lt;code class=&quot;highlighter-rouge&quot;&gt;fsutil 8dot3name query&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;关闭该功能：&lt;code class=&quot;highlighter-rouge&quot;&gt;fsutil 8dot3name set 1&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;windows-server-2003&quot;&gt;Windows Server 2003&lt;/h3&gt;

&lt;p&gt;关闭该功能：&lt;code class=&quot;highlighter-rouge&quot;&gt;fsutil behavior set disable8dot3 1&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;最后&quot;&gt;最后&lt;/h3&gt;

&lt;p&gt;重启服务器&lt;/p&gt;

</description>
        <pubDate>Fri, 27 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-27/2</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-27/2</guid>
        
        
        <category>Web安全测试学习手册</category>
        
      </item>
    
      <item>
        <title>新生活 - 上海，我来了</title>
        <description>&lt;!--more--&gt;

&lt;p&gt;完成了一个梦想，真好，转眼间逝去的两年，我不断成长，感受人情冷暖、接纳新鲜事物，至今已学会如何照顾自己，让生活更具有色彩，人生更加无憾。&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;谢谢我的朋友们给我的支持！&lt;/p&gt;

</description>
        <pubDate>Fri, 20 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-20/1</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-20/1</guid>
        
        
        <category>生活</category>
        
      </item>
    
      <item>
        <title>服务器启用了不安全的HTTP方法</title>
        <description>&lt;p&gt;《Web安全测试学习手册》- 服务器启用了不安全的HTTP方法
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x00-不安全的http方法&quot;&gt;0x00 不安全的HTTP方法&lt;/h2&gt;

&lt;h3 id=&quot;1什么是不安全的http方法&quot;&gt;1）什么是不安全的HTTP方法&lt;/h3&gt;

&lt;p&gt;开发人员、运维人员一般可能用于调试服务器，开启了一些客户端能够直接读写服务器端文件的方法，例如： DELETE, PUT, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, LOCK, UNLOCK 等HTTP协议支持的方法。&lt;/p&gt;

&lt;h3 id=&quot;2不安全的http方法特点&quot;&gt;2）不安全的HTTP方法特点&lt;/h3&gt;

&lt;p&gt;可通过浏览器直接读写服务器端文件&lt;/p&gt;

&lt;h2 id=&quot;0x01-不安全的http方法---风险等级&quot;&gt;0x01 不安全的HTTP方法 - 风险等级&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;高&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x02-不安全的http方法---原理&quot;&gt;0x02 不安全的HTTP方法 - 原理&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;方法&lt;/th&gt;
      &lt;th&gt;说明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;PUT&lt;/td&gt;
      &lt;td&gt;向指定的目录上载文件&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DELETE&lt;/td&gt;
      &lt;td&gt;删除指定的资源&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;COPY&lt;/td&gt;
      &lt;td&gt;将指定的资源复制到Destination消息头指定的位置&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;MOVE&lt;/td&gt;
      &lt;td&gt;将指定的资源移动到Destination消息头指定的位置&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SEARCH&lt;/td&gt;
      &lt;td&gt;在一个目录路径中搜索资源&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;PROPFIND&lt;/td&gt;
      &lt;td&gt;获取与指定资源有关的信息，如作者、大小与内容类型&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;TRACE&lt;/td&gt;
      &lt;td&gt;在响应中返回服务器收到的原始请求&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;服务器端由于配置权限不当，导致允许了客户端发送 DELETE, PUT, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, LOCK, UNLOCK等请求，并且解析请求进行操作文件。&lt;/p&gt;

&lt;h2 id=&quot;0x03-不安全的http方法---常见场景&quot;&gt;0x03 不安全的HTTP方法 - 常见场景&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Tomcat 中间件&lt;/li&gt;
  &lt;li&gt;IIS 中间件&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x04-测试方案&quot;&gt;0x04 测试方案&lt;/h2&gt;

&lt;p&gt;使用CURL发送OPTIONS请求，查看响应头中的Allow行&lt;/p&gt;

&lt;p&gt;命令：&lt;code class=&quot;highlighter-rouge&quot;&gt;curl -I -X OPTIONS http://payloads.online&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;➜  ~ curl -I -X OPTIONS http://10.211.55.16/
HTTP/1.1 200 OK
Date: Wed, 18 Apr 2018 02:17:47 GMT
Server: Microsoft-IIS/6.0
MS-Author-Via: DAV
Content-Length: 0
Accept-Ranges: none
DASL: &amp;lt;DAV:sql&amp;gt;
DAV: 1, 2
Public: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH
Allow: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK
Cache-Control: private
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;若出现PUT、DELETE….等方法，则存在此风险&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-04-18/0x00.png&quot; alt=&quot;0x00&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;0x05-修复方案&quot;&gt;0x05 修复方案&lt;/h2&gt;

&lt;h3 id=&quot;iis&quot;&gt;IIS&lt;/h3&gt;

&lt;p&gt;修改站点权限，取消“写入”&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-04-18/0x01.gif&quot; alt=&quot;0x01&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;tomcat&quot;&gt;Tomcat&lt;/h3&gt;

&lt;p&gt;修改&lt;code class=&quot;highlighter-rouge&quot;&gt;web.xml&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;security-constraint&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;web-resource-collection&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;web-resource-name&amp;gt;&lt;/span&gt;fortune&lt;span class=&quot;nt&quot;&gt;&amp;lt;/web-resource-name&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/*&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;http-method&amp;gt;&lt;/span&gt;PUT&lt;span class=&quot;nt&quot;&gt;&amp;lt;/http-method&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;http-method&amp;gt;&lt;/span&gt;DELETE&lt;span class=&quot;nt&quot;&gt;&amp;lt;/http-method&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;http-method&amp;gt;&lt;/span&gt;HEAD&lt;span class=&quot;nt&quot;&gt;&amp;lt;/http-method&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;http-method&amp;gt;&lt;/span&gt;OPTIONS&lt;span class=&quot;nt&quot;&gt;&amp;lt;/http-method&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;http-method&amp;gt;&lt;/span&gt;TRACE&lt;span class=&quot;nt&quot;&gt;&amp;lt;/http-method&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/web-resource-collection&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;auth-constraint&amp;gt;&amp;lt;/auth-constraint&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/security-constraint&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;login-config&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;auth-method&amp;gt;&lt;/span&gt;BASIC&lt;span class=&quot;nt&quot;&gt;&amp;lt;/auth-method&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/login-config&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;nginx&quot;&gt;Nginx&lt;/h3&gt;

&lt;p&gt;在 &lt;code class=&quot;highlighter-rouge&quot;&gt;server&lt;/code&gt;代码块内写入如下代码，用于屏蔽非GET、POST请求：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;if ($request_method !~* GET|POST) {
            return 403;

   }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
        <pubDate>Wed, 18 Apr 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/archivers/2018-04-18/1</link>
        <guid isPermaLink="true">http://localhost:4000/archivers/2018-04-18/1</guid>
        
        
        <category>内网渗透</category>
        
      </item>
    
  </channel>
</rss>
